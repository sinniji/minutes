<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è­°äº‹éŒ²ä¸€è¦§</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }
        
        input[type="password"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }
        
        input[type="password"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }
        
        button {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
            color: #667eea;
        }
        
        .error {
            display: none;
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #c62828;
        }
        
        .success {
            display: none;
            background: #e8f5e8;
            color: #2e7d32;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #2e7d32;
        }
        
        .files-container {
            display: none;
            margin-top: 30px;
        }
        
        .files-title {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .file-list {
            list-style: none;
            padding: 0;
        }
        
        .file-item {
            background: #f8f9fa;
            margin: 10px 0;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .file-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .file-link {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            text-decoration: none;
            color: #333;
            transition: all 0.3s ease;
        }
        
        .file-link:hover {
            background: #e9ecef;
            color: #667eea;
        }
        
        .file-icon {
            font-size: 1.5em;
            margin-right: 12px;
            color: #dc3545;
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            font-weight: 500;
            font-size: 1.1em;
            margin-bottom: 4px;
        }
        
        .file-details {
            font-size: 0.9em;
            color: #666;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ è­°äº‹éŒ²ä¸€è¦§</h1>
        
        <form id="passwordForm">
            <div class="form-group">
                <label for="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</label>
                <input type="password" id="password" name="password" required placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
            </div>
            <button type="submit" id="submitBtn">
                <span id="buttonText">é€ä¿¡</span>
            </button>
        </form>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>èªè¨¼ä¸­...</p>
        </div>
        
        <div class="error" id="errorMessage"></div>
        <div class="success" id="successMessage"></div>
        
        <div class="files-container" id="filesContainer">
            <h2 class="files-title">ğŸ“„ åˆ©ç”¨å¯èƒ½ãªPDFãƒ•ã‚¡ã‚¤ãƒ«</h2>
            <ul class="file-list" id="fileList"></ul>
        </div>
    </div>

    <script>
        
document.addEventListener('DOMContentLoaded', () => {
    // =================================================================
    // è¨­å®šé …ç›®
    // =================================================================

    //ã€æœ€é‡è¦ã€‘å¿…ãšGASã®ã€Œãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¾Œã®æœ€çµ‚çš„ãªURLã€ã‚’è¨­å®šã—ã¦ãã ã•ã„
    // 1. GASã®Webã‚¢ãƒ—ãƒªURLã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§ä¸€åº¦é–‹ã
    // 2. è¡¨ç¤ºã•ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã‚‹
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbyFgrivnyhzJRKJQWPAfm4KS-I-jMtVGNo9S11U9uYJj5Hjln0pV3LguhLxBF_vpL3F/exec'; // â† ã‚ãªãŸã®æœ€çµ‚URLã«æ›¸ãæ›ãˆã¦ãã ã•ã„


    // =================================================================
    // è¦ç´ ã®å–å¾—
    // =================================================================

    const passwordForm = document.getElementById('passwordForm');
    const passwordInput = document.getElementById('password');
    const submitBtn = document.getElementById('submitBtn');
    const buttonText = document.getElementById('buttonText');
    const loadingSpinner = document.getElementById('loading');
    const errorMessage = document.getElementById('errorMessage');
    const successMessage = document.getElementById('successMessage');
    const filesContainer = document.getElementById('filesContainer');


    // =================================================================
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    // =================================================================

    passwordForm.addEventListener('submit', async (e) => {
        e.preventDefault(); // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé€ä¿¡ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«

        const password = passwordInput.value;

        // --- UIã‚’ãƒªã‚»ãƒƒãƒˆã—ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã¸ ---
        hideAllMessages();
        setLoadingState(true);

        try {
            // --- fetchã‚’ä½¿ç”¨ã—ã¦GASã«POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ ---
            const response = await fetch(GAS_URL, {
                method: 'POST',
                headers: {
                    // ã“ã‚Œã‹ã‚‰é€ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯JSONå½¢å¼ã§ã‚ã‚‹ã“ã¨ã‚’æ˜è¨˜
                    'Content-Type': 'application/json',
                },
                // JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’JSONæ–‡å­—åˆ—ã«å¤‰æ›ã—ã¦é€ä¿¡
                body: JSON.stringify({ password: password }),
            });

            // HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ200ç•ªå°ã§ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦æ‰±ã†
            if (!response.ok) {
                throw new Error(`ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”ã‚¨ãƒ©ãƒ¼: ${response.status} ${response.statusText}`);
            }

            // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’JSONã¨ã—ã¦è§£æ
            const data = await response.json();
            console.log('GASã‹ã‚‰ã®å¿œç­”ãƒ‡ãƒ¼ã‚¿:', data);

            if (data.success) {
                // --- æˆåŠŸæ™‚ã®å‡¦ç† ---
                successMessage.textContent = data.message || 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ã«æˆåŠŸã—ã¾ã—ãŸï¼';
                successMessage.style.display = 'block';
                displayFiles(data.files); // ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’è¡¨ç¤º
            } else {
                // --- GASå´ã§ã‚¨ãƒ©ãƒ¼ãŒè¿”ã•ã‚ŒãŸå ´åˆã®å‡¦ç† ---
                errorMessage.textContent = data.message || 'èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚';
                errorMessage.style.display = 'block';
            }

        } catch (error) {
            // --- é€šä¿¡å¤±æ•—æ™‚ã®å‡¦ç† (ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãªã©) ---
            console.error('é€šä¿¡ã‚¨ãƒ©ãƒ¼:', error);
            errorMessage.textContent = 'ã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
            errorMessage.style.display = 'block';
        } finally {
            // --- æˆåŠŸãƒ»å¤±æ•—ã«é–¢ã‚ã‚‰ãšã€æœ€å¾Œã«å¿…ãšå®Ÿè¡Œã™ã‚‹å‡¦ç† ---
            setLoadingState(false); // UIã‚’ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è§£é™¤çŠ¶æ…‹ã¸
        }
    });


    // =================================================================
    // UIæ“ä½œã®ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
    // =================================================================

    /**
     * ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’è¨­å®šã¾ãŸã¯è§£é™¤ã™ã‚‹é–¢æ•°
     * @param {boolean} isLoading - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã«ã™ã‚‹å ´åˆã¯ true
     */
    function setLoadingState(isLoading) {
        submitBtn.disabled = isLoading;
        loadingSpinner.style.display = isLoading ? 'block' : 'none';
        buttonText.textContent = isLoading ? 'èªè¨¼ä¸­...' : 'é€ä¿¡';
    }

    /**
     * ã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆæˆåŠŸãƒ»ã‚¨ãƒ©ãƒ¼ï¼‰ã‚’éè¡¨ç¤ºã«ã™ã‚‹é–¢æ•°
     */
    function hideAllMessages() {
        errorMessage.style.display = 'none';
        successMessage.style.display = 'none';
        filesContainer.innerHTML = ''; // ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’ã‚¯ãƒªã‚¢
    }

    /**
     * ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’ç”»é¢ã«è¡¨ç¤ºã™ã‚‹é–¢æ•°ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰
     * @param {Array<Object>} files - GASã‹ã‚‰å—ã‘å–ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã®é…åˆ—
     */
    function displayFiles(files) {
        // ä»¥å‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’ã‚¯ãƒªã‚¢
        filesContainer.innerHTML = '';

        if (!files || files.length === 0) {
            filesContainer.innerHTML = '<p>è¡¨ç¤ºã§ãã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
            return;
        }

        const ul = document.createElement('ul');
        files.forEach(file => {
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = file.url;
            a.textContent = file.name;
            a.target = '_blank'; // æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
            a.rel = 'noopener noreferrer';
            li.appendChild(a);
            ul.appendChild(li);
        });
        filesContainer.appendChild(ul);
    }
});        
        function hideAllMessages() {
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('filesContainer').style.display = 'none';
        }
        
        function displayFiles(files) {
            const fileList = document.getElementById('fileList');
            const filesContainer = document.getElementById('filesContainer');
            
            // ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
            fileList.innerHTML = '';
            
            if (files && files.length > 0) {
                files.forEach(file => {
                    const listItem = document.createElement('li');
                    listItem.className = 'file-item';
                    
                    const link = document.createElement('a');
                    link.href = file.url;
                    link.className = 'file-link';
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                    
                    // PDFã‚¢ã‚¤ã‚³ãƒ³
                    const icon = document.createElement('div');
                    icon.className = 'file-icon';
                    icon.textContent = 'ğŸ“„';
                    
                    // ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã‚³ãƒ³ãƒ†ãƒŠ
                    const fileInfo = document.createElement('div');
                    fileInfo.className = 'file-info';
                    
                    // ãƒ•ã‚¡ã‚¤ãƒ«å
                    const fileName = document.createElement('div');
                    fileName.className = 'file-name';
                    fileName.textContent = file.name;
                    
                    // ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°ï¼ˆã‚µã‚¤ã‚ºã¨æ›´æ–°æ—¥ï¼‰
                    const fileDetails = document.createElement('div');
                    fileDetails.className = 'file-details';
                    
                    const updateDate = new Date(file.lastModified);
                    const formattedDate = updateDate.toLocaleDateString('ja-JP');
                    fileDetails.textContent = `${file.size} â€¢ æ›´æ–°æ—¥: ${formattedDate}`;
                    
                    // è¦ç´ ã‚’çµ„ã¿ç«‹ã¦
                    fileInfo.appendChild(fileName);
                    fileInfo.appendChild(fileDetails);
                    
                    link.appendChild(icon);
                    link.appendChild(fileInfo);
                    listItem.appendChild(link);
                    fileList.appendChild(listItem);
                });
                
                filesContainer.style.display = 'block';
            } else {
                const listItem = document.createElement('li');
                listItem.className = 'file-item';
                listItem.innerHTML = '<div class="file-link"><div class="file-icon">ğŸ“</div><div class="file-info"><div class="file-name">åˆ©ç”¨å¯èƒ½ãªPDFãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</div></div></div>';
                fileList.appendChild(listItem);
                filesContainer.style.display = 'block';
            }
        }
    </script>
</body>
</html>
